/* .vitepress/theme/custom.css - 最终完美版 (去Curtain + 修复所有已知问题) */

/* ========================================================= */
/* 0. 全局配置 & 核心变量 */
/* ========================================================= */
html {
  scroll-behavior: smooth !important;
  /* 锚点跳转留出间隙，防止被导航栏遮挡 */
  scroll-padding-top: calc(var(--vp-nav-height) + 50px);
}

:root {
  /* --- 亮色模式 --- */
  --vp-c-bg: #f7f9fc;
  --vp-c-bg-soft: #ffffff;
  --vp-c-bg-alt: #f1f4f8;
  --vp-c-text-1: #1e293b;
  --vp-c-text-2: #475569;
  
  --vp-c-brand-1: #4a90e2;
  --vp-c-brand-2: #3a7fd6;
  --vp-c-brand-rgb: 74, 144, 226; 
  
  /* 柔和的品牌背景色 (用于选中态) */
  --vp-c-brand-soft: rgba(74, 144, 226, 0.1);
  
  --vp-c-divider: #e2e8f0;     
  --vp-container-bg: #fcfdff;   
  --vp-card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  
  /* 布局变量 */
  --vp-nav-height: 64px; 
  --vp-local-nav-height: 48px; /* 目录栏高度 */
  --vp-sidebar-width: 280px;
  
  /* 侧边栏卡片间距变量 */
  --sidebar-gap-top: 20px;
  --sidebar-gap-left: 20px;
  --sidebar-gap-bottom: 20px;

  /* 毛玻璃配置 */
  --glass-bg-light: rgba(255, 255, 255, 0.85);
  --glass-bg-dark: rgba(30, 32, 40, 0.85);
  --glass-border-light: rgba(255, 255, 255, 0.6);
  --glass-border-dark: rgba(255, 255, 255, 0.1);

  /* Mac代码块变量 */
  --mac-red: #ff5c5a; --mac-yellow: #ffc22e; --mac-green: #2ecc71;
  --mac-header-height: 30px; --vp-code-padding: 16px;
  --mac-header-bg: #ebeef0; --mac-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  --mac-content-start-top: calc(var(--mac-header-height) + var(--vp-code-padding));
}

:root.dark {
  /* --- 暗色模式 --- */
  --vp-c-bg: #1a202c;
  --vp-c-bg-soft: #252d3a;
  --vp-c-bg-alt: #1f2530;
  --vp-c-text-1: #f1f5f9;
  --vp-c-text-2: #94a3b8;
  
  --vp-c-brand-1: #79c0ff;
  --vp-c-brand-2: #65a8d9;
  --vp-c-brand-rgb: 121, 192, 255; 
  --vp-c-brand-soft: rgba(121, 192, 255, 0.15);
  
  --vp-c-divider: #475569;
  --vp-container-bg: #2c3440;
  --vp-card-shadow: 0 4px 10px rgba(255, 255, 255, 0.05);
  
  --mac-header-bg: #2c3a4a; --mac-box-shadow: 0 0 10px rgba(255, 255, 255, 0.06);
}

/* ========================================================= */
/* PART A: 组件样式 (代码块/卡片/表格/按钮) - 保持不变 */
/* ========================================================= */

/* 1. Custom Containers */
.VPDoc div[class*='custom-container'] {
    border: none !important; border-radius: 10px !important; 
    padding: 16px 20px !important; margin: 1.5rem 0 !important;
    background-color: var(--vp-container-bg) !important; 
    box-shadow: var(--vp-card-shadow); position: relative; overflow: hidden;
}
.VPDoc div[class*='custom-container']::before {
    content: ''; position: absolute; top: 0; left: 0; width: 6px; height: 100%; z-index: 1;
}
.VPDoc div.custom-container.tip::before { background-color: var(--vp-c-tip); }
.VPDoc div.custom-container.warning::before { background-color: var(--vp-c-warning); }
.VPDoc div.custom-container.danger::before { background-color: var(--vp-c-danger); }
.VPDoc div.custom-container.info::before { background-color: var(--vp-c-info); }
.VPDoc div.custom-container.details::before { background-color: var(--vp-c-details); }

.VPDoc div[class*='custom-container'] p.custom-container-title {
    font-weight: 700 !important; margin: 0 0 8px 0 !important; padding-left: 20px !important;
    font-size: 1.05rem; position: relative; color: var(--vp-c-text-1) !important;
}
.VPDoc div[class*='custom-container'] p.custom-container-title::after {
    content: 'i'; position: absolute; left: 0; top: 50%; transform: translateY(-50%);
    font-family: inherit; font-size: 1.1em; font-weight: bold;
}
.VPDoc div.custom-container.tip p.custom-container-title { color: var(--vp-c-tip) !important; }
.VPDoc div.custom-container.warning p.custom-container-title { color: var(--vp-c-warning) !important; }
.VPDoc div.custom-container.danger p.custom-container-title { color: var(--vp-c-danger) !important; }
.VPDoc div.custom-container.info p.custom-container-title { color: var(--vp-c-info) !important; }

/* 2. macOS 代码块 */
.VPDoc div[class*='language-'] {
    position: relative; border: none; border-radius: 12px; margin: 2rem 0; overflow: hidden;
    box-shadow: var(--mac-box-shadow); z-index: 1;
}
.VPDoc div[class*='language-']::before {
    content: ''; position: absolute; top: 0; left: 0; height: var(--mac-header-height); width: 100%;
    background-color: var(--mac-header-bg); border-radius: 12px 12px 0 0; z-index: 10;
}
.VPDoc div[class*='language-']::after {
    content: ''; position: absolute; top: 10px; left: 12px; height: 10px; width: 10px;
    background-color: var(--mac-red); border-radius: 50%; z-index: 11;
    box-shadow: 18px 0 0 var(--mac-yellow), 36px 0 0 var(--mac-green);
}
.VPDoc div[class*='language-'] pre {
    padding-top: var(--mac-content-start-top) !important; 
    padding-left: 24px; padding-right: 24px; position: relative; z-index: 5;
}
.VPDoc div[class*='language-'] .line-numbers-wrapper { padding-top: var(--mac-content-start-top) !important; }
.VPDoc div[class*='language-'] .lang {
    position: absolute; top: 0; right: 0; left: 0; z-index: 10; text-align: center;
    line-height: var(--mac-header-height); height: var(--mac-header-height);
    font-size: 0.85rem; font-weight: 500; text-transform: uppercase;
    color: var(--vp-c-text-1); background-color: transparent !important; opacity: 0.8;
}
.VPDoc div[class*='language-'] .copy { top: 6px !important; right: 6px !important; z-index: 12; }

/* 3. 分页/表格/Top */
.VPDocFooter .next-and-prev-link .pager-link {
    border: 1px solid var(--vp-c-divider) !important; border-radius: 12px;
    background-color: var(--vp-c-bg-soft) !important;
    box-shadow: var(--vp-card-shadow); transition: all 0.3s;
}
.VPDocFooter .next-and-prev-link .pager-link:hover {
    border-color: var(--vp-c-brand-1) !important; transform: translateY(-3px);
}
.VPDoc .table-wrapper table {
    border-radius: 8px !important; box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    border: 1px solid var(--vp-c-divider) !important;
}
.VPBackToTop {
    background-color: var(--vp-c-brand-1); color: #fff;
    box-shadow: 0 4px 12px rgba(var(--vp-c-brand-rgb), 0.4);
}


/* ========================================================= */
/* PART B: 布局重构 (通用) */
/* ========================================================= */

/* 1. 导航栏 (Navbar) - 100vw 全屏贯穿 */
.VPNav {
    position: fixed !important;
    top: 0; left: 0; 
    width: 100vw !important; 
    height: var(--vp-nav-height);
    z-index: 60 !important; 
    
    background-color: var(--vp-c-bg) !important; 
    border-bottom: 1px solid var(--vp-c-divider);
    box-sizing: border-box; 
}
.VPNav .VPContainer {
    max-width: 100% !important; padding: 0 24px !important; margin: 0 !important;
}
.VPNavBar { background-color: transparent !important; border-bottom: none !important; }

/* 2. 侧边栏通用样式 (玻璃/阴影) */

/* 
   ★ 关键修改：隐藏侧边栏内的【重复标题】和【遮罩curtain】 
*/
.VPSidebar .VPNavBarTitle, 
.VPSidebar .curtain { 
    display: none !important; 
}

.VPSidebar {
    z-index: 50 !important; 
    
    /* 默认毛玻璃背景 (亮色) */
    background-color: var(--glass-bg-light) !important;
    backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
    
    /* 边框与阴影 */
    border-right: none !important;
    border: 1px solid var(--glass-border-light); 
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08); 
    
    /* 圆角与内边距 */
    border-radius: 16px !important;
    padding-top: 20px !important;
    padding-bottom: 20px !important;
    
    /* 交互修复 */
    overflow-y: auto;
    pointer-events: auto !important; 
}

/* 暗色模式适配 */
:root.dark .VPSidebar {
    background-color: var(--glass-bg-dark) !important;
    border: 1px solid var(--glass-border-dark) !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

/* 侧边栏链接 - 纯色极简风格 */
.VPSidebar .link {
    border-radius: 8px !important;
    margin: 4px 12px !important;
    padding: 10px 14px !important;
    transition: all 0.2s cubic-bezier(0.25, 0.8, 0.25, 1);
    border: none !important;
}
.VPSidebar .link:hover {
    background-color: var(--vp-c-bg-alt) !important;
    transform: translateX(4px);
}
/* 选中态：纯色柔和背景 */
.VPSidebar .link.active {
    background-color: var(--vp-c-brand-soft) !important; 
    color: var(--vp-c-brand-1) !important; 
    font-weight: 600;
    box-shadow: none !important; 
    transform: translateX(0);
}
.VPSidebar .link.active .text { color: var(--vp-c-brand-1) !important; }


/* ========================================================= */
/* PART C: 桌面端布局 (Desktop >= 960px) */
/* ========================================================= */
@media (min-width: 960px) {
    .VPSidebar {
        position: fixed !important;
        top: calc(var(--vp-nav-height) + var(--sidebar-gap-top)) !important; 
        bottom: var(--sidebar-gap-bottom) !important;
        left: var(--sidebar-gap-left) !important;
        width: var(--vp-sidebar-width) !important;
    }

    .VPContent.has-sidebar {
        padding-left: calc(var(--vp-sidebar-width) + var(--sidebar-gap-left) + 32px) !important;
        padding-right: 32px !important;
        padding-top: calc(var(--vp-nav-height) + 32px) !important;
    }
    .VPContent.has-sidebar .VPDoc {
        width: 100% !important; max-width: 100% !important; padding: 0 !important;
    }
    .VPContent.has-sidebar .VPDoc .container {
        max-width: 1100px !important; margin: 0 auto !important; 
        display: flex; justify-content: center;
    }
    .VPContent.has-sidebar .VPDoc .content { max-width: 800px; width: 100%; }
    .VPContent.has-sidebar .VPDoc .aside { display: block !important; padding-left: 32px; }
}

/* 中等屏幕适配 (Tablet) */
@media (min-width: 960px) and (max-width: 1279px) {
    .VPContent.has-sidebar .VPDoc .aside { display: none !important; }
}


/* ========================================================= */
/* PART D: 手机端完全修复 (Mobile < 960px) */
/* ========================================================= */
@media (max-width: 960px) {
    
    /* 1. 导航栏内边距 */
    .VPNav .VPContainer { padding: 0 16px !important; }
    
    /* 2. 手机端目录栏 (VPLocalNav) - 毛玻璃 + z-index控制 */
    .VPLocalNav {
        position: sticky !important;
        top: var(--vp-nav-height) !important;
        z-index: 55 !important; 
        
        background-color: var(--glass-bg-light) !important;
        backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--vp-c-divider);
        padding-left: 16px;
    }
    :root.dark .VPLocalNav { background-color: var(--glass-bg-dark) !important; }
    
    /* 
       3. 手机端侧边栏 - 位置修复
       top = NavHeight(64) + LocalNavHeight(48) + Gap(10) = ~122px
       这样它会刚好位于“目录栏”的下方
    */
    .VPSidebar {
        position: fixed !important;
        top: calc(var(--vp-nav-height) + var(--vp-local-nav-height) + 10px) !important;
        left: 10px !important;
        right: 10px !important; 
        bottom: 10px !important;
        width: auto !important;
        
        overflow-y: auto !important;
        overscroll-behavior: contain;
        
        box-shadow: 0 10px 40px rgba(0,0,0,0.15) !important;
    }
    
    /* 手机端侧边栏标题 (显示) */
    .VPSidebar .VPNavBarTitle { 
        display: flex !important; 
        padding: 10px 10px 20px 10px;
        border-bottom: 1px dashed var(--vp-c-divider);
        margin-bottom: 10px;
    }
    
    /* 手机端链接样式 (还原) */
    .VPSidebar .link { border-radius: 0 !important; margin: 0 !important; }
    .VPSidebar .link.active { background: transparent !important; color: var(--vp-c-brand-1) !important; box-shadow: none !important; }
    .VPSidebar .link.active .text { color: var(--vp-c-brand-1) !important; }

    /* 4. 内容区域修正 */
    .VPContent { padding-top: var(--vp-nav-height) !important; }
    .VPDoc { padding: 20px 16px !important; }
    
    /* 5. 遮罩层 */
    .VPBackdrop {
        z-index: 45 !important;
        background-color: rgba(0,0,0,0.3) !important;
        backdrop-filter: blur(3px);
    }
}