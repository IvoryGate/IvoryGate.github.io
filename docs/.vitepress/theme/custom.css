/* .vitepress/theme/custom.css - 最终完美版 (已设置 VPSidebar 32px 内边距) */

/* ========================================================= */
/* 0A. 字体导入 */
/* ========================================================= */
@import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap'); /* 代码字体 */
@import './mermaid.css';

/* ========================================================= */
/* 0. 全局配置 & 核心变量 */
/* ========================================================= */
html {
  scroll-behavior: smooth !important;
  scroll-padding-top: calc(var(--vp-nav-height) + 50px);
  
  /* ------------------------------------------------ */
  /* ★ 字体配置：仿宋 (中文) + Merriweather (英文) ★ */
  /* ------------------------------------------------ */
  font-family: 
    'Merriweather',   
    '仿宋', 'FangSong', 'STFangsong', 
    'serif';          
}

:root {
  /* --- 亮色模式 --- */
  --vp-c-bg: #f7f9fc;
  --vp-c-bg-soft: #ffffff;
  --vp-c-bg-alt: #f1f4f8;
  --vp-c-text-1: #1e293b;
  --vp-c-text-2: #475569;
  
  --vp-c-brand-1: #4a90e2;
  --vp-c-brand-2: #3a7fd6;
  --vp-c-brand-rgb: 74, 144, 226; 
  
  --vp-c-brand-soft: rgba(74, 144, 226, 0.1);
  
  --vp-c-divider: #e2e8f0;     
  --vp-container-bg: #fcfdff;   
  --vp-card-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); 
  
  /* 布局变量 */
  --vp-nav-height: 64px; 
  --vp-local-nav-height: 48px; 
  --vp-sidebar-width: 280px;
  
  /* 侧边栏卡片间距变量 (统一设置为 32px) */
  --sidebar-gap-top: 32px; /* ★ 修改为 32px ★ */
  --sidebar-gap-left: 32px; /* ★ 修改为 32px ★ */
  --sidebar-gap-bottom: 32px; /* ★ 修改为 32px ★ */
  /* 侧边栏与内容区的间隔 */
  --sidebar-content-gap: 32px; 
  /* 侧边栏总宽度（含内容与内容间距） */
  --sidebar-full-width: calc(var(--vp-sidebar-width) + var(--sidebar-content-gap));
  /* 内容区最大宽度 (用于居中计算) */
  --vp-layout-max-width: 1440px; 
  /* 核心内容区域宽度 (VitePress 默认设置) */
  --doc-content-width: 800px; 
  
  /* 代码字体变量 */
  --vp-font-family-mono: 'JetBrains Mono', Consolas, 'Courier New', monospace;

  /* 毛玻璃配置 */
  --glass-bg-light: rgba(255, 255, 255, 0.85);
  --glass-bg-dark: rgba(30, 32, 40, 0.85);
  --glass-border-light: rgba(255, 255, 255, 0.6);
  --glass-border-dark: rgba(255, 255, 255, 0.1);

  /* Mac代码块变量 */
  --mac-red: #ff5c5a; --mac-yellow: #ffc22e; --mac-green: #2ecc71;
  --mac-header-height: 30px; --vp-code-padding: 16px;
  --mac-header-bg: #ebeef0; --mac-box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  --mac-content-start-top: calc(var(--mac-header-height) + var(--vp-code-padding));
}

:root.dark {
  /* --- 暗色模式 --- */
  --vp-c-bg: #1a202c;
  --vp-c-bg-soft: #252d3a;
  --vp-c-bg-alt: #1f2530;
  --vp-c-text-1: #f1f5f9;
  --vp-c-text-2: #94a3b8;
  
  --vp-c-brand-1: #79c0ff;
  --vp-c-brand-2: #65a8d9;
  --vp-c-brand-rgb: 121, 192, 255; 
  --vp-c-brand-soft: rgba(121, 192, 255, 0.15);
  
  --vp-c-divider: #475569;
  --vp-container-bg: #2c3440;
  
  --vp-card-shadow: 0 4px 16px rgba(255, 255, 255, 0.05); 
  
  --mac-header-bg: #2c3a4a; --mac-box-shadow: 0 0 10px rgba(255, 255, 255, 0.06);
}

/* ========================================================= */
/* PART B: 字体应用 (JetBrains Mono) */
/* ========================================================= */
.VPDoc code, 
.VPDoc div[class*='language-'] pre,
.VPDoc div[class*='language-'] code {
  font-family: var(--vp-font-family-mono) !important;
}

/* ========================================================= */
/* PART A: 组件样式 (代码块/卡片/表格/按钮) */
/* ========================================================= */

/* 1. Custom Containers */
.VPDoc div[class*='custom-container'] {
    border: none !important; border-radius: 10px !important; 
    padding: 16px 20px !important; margin: 1.5rem 0 !important;
    background-color: var(--vp-container-bg) !important; 
    box-shadow: var(--vp-card-shadow); position: relative; overflow: hidden;
}
.VPDoc div[class*='custom-container']::before {
    content: ''; position: absolute; top: 0; left: 0; width: 6px; height: 100%; z-index: 1;
}
.VPDoc div.custom-container.tip::before { background-color: var(--vp-c-tip); }
.VPDoc div.custom-container.warning::before { background-color: var(--vp-c-warning); }
.VPDoc div.custom-container.danger::before { background-color: var(--vp-c-danger); }
.VPDoc div.custom-container.info::before { background-color: var(--vp-c-info); }
.VPDoc div.custom-container.details::before { background-color: var(--vp-c-details); }

.VPDoc div[class*='custom-container'] p.custom-container-title {
    font-weight: 700 !important; margin: 0 0 8px 0 !important; padding-left: 20px !important;
    font-size: 1.05rem; position: relative; color: var(--vp-c-text-1) !important;
}
.VPDoc div[class*='custom-container'] p.custom-container-title::after {
    content: 'i'; position: absolute; left: 0; top: 50%; transform: translateY(-50%);
    font-family: inherit; font-size: 1.1em; font-weight: bold;
}
.VPDoc div.custom-container.tip p.custom-container-title { color: var(--vp-c-tip) !important; }
.VPDoc div.custom-container.warning p.custom-container-title { color: var(--vp-c-warning) !important; }
.VPDoc div.custom-container.danger p.custom-container-title { color: var(--vp-c-danger) !important; }
.VPDoc div.custom-container.info p.custom-container-title { color: var(--vp-c-info) !important; }

/* 2. macOS 代码块 */
.VPDoc div[class*='language-'] {
    position: relative; border: none; border-radius: 12px; margin: 2rem 0; overflow: hidden;
    box-shadow: var(--mac-box-shadow); z-index: 1;
}
.VPDoc div[class*='language-']::before {
    content: ''; position: absolute; top: 0; left: 0; height: var(--mac-header-height); width: 100%;
    background-color: var(--mac-header-bg); border-radius: 12px 12px 0 0; z-index: 10;
}
.VPDoc div[class*='language-']::after {
    content: ''; position: absolute; top: 10px; left: 12px; height: 10px; width: 10px;
    background-color: var(--mac-red); border-radius: 50%; z-index: 11;
    box-shadow: 18px 0 0 var(--mac-yellow), 36px 0 0 var(--mac-green);
}
.VPDoc div[class*='language-'] pre {
    padding-top: var(--mac-content-start-top) !important; 
    padding-left: 24px; padding-right: 24px; position: relative; z-index: 5;
}
.VPDoc div[class*='language-'] .line-numbers-wrapper { padding-top: var(--mac-content-start-top) !important; }
.VPDoc div[class*='language-'] .lang {
    position: absolute; top: 0; right: 0; left: 0; z-index: 10; text-align: center;
    line-height: var(--mac-header-height); height: var(--mac-header-height);
    font-size: 0.85rem; font-weight: 500; text-transform: uppercase;
    color: var(--vp-c-text-1); background-color: transparent !important; opacity: 0.8;
}
.VPDoc div[class*='language-'] .copy { top: 6px !important; right: 6px !important; z-index: 12; }

/* 3. 分页/表格/Top */
.VPDocFooter .next-and-prev-link .pager-link {
    border: 1px solid var(--vp-c-divider) !important; border-radius: 12px;
    background-color: var(--vp-c-bg-soft) !important;
    box-shadow: var(--vp-card-shadow); transition: all 0.3s;
}
.VPDocFooter .next-and-prev-link .pager-link:hover {
    border-color: var(--vp-c-brand-1) !important; transform: translateY(-3px);
}
.VPDoc .table-wrapper table {
    border-radius: 8px !important; box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    border: 1px solid var(--vp-c-divider) !important;
}
.VPBackToTop {
    background-color: var(--vp-c-brand-1); color: #fff;
    box-shadow: 0 4px 12px rgba(var(--vp-c-brand-rgb), 0.4);
}


/* ========================================================= */
/* PART E: 图片增强样式 (Images) */
/* ========================================================= */

.VPDoc img {
    border: none !important;
    margin: 0 !important;
}

/* 1. 悬浮卡片效果：应用于包裹在 <p> 标签内的图片 */
.VPDoc p > img {
    display: block;
    margin: 1.5rem auto !important; 
    
    max-width: 100%;
    border-radius: 12px;
    box-shadow: var(--vp-card-shadow); 
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
    
    object-fit: contain;
    overflow: hidden; 
}

/* 悬停效果 (亮色模式) */
.VPDoc p > img:hover {
    transform: translateY(-5px); 
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15); 
}


/* 2. 暗色模式图片优化 */
:root.dark .VPDoc p > img {
    filter: invert(0.9) hue-rotate(180deg) brightness(0.9) contrast(0.95);
    border: 1px solid var(--vp-c-divider); 
    box-shadow: 0 4px 12px rgba(var(--vp-c-brand-rgb), 0.3) !important; 
}

/* 悬停效果 (暗色模式) */
:root.dark .VPDoc p > img:hover {
    transform: translateY(-5px); 
    box-shadow: 0 4px 12px rgba(var(--vp-c-brand-rgb), 0.5) !important; 
}

/* 3. 排除滤镜的图片 (对于 Logo/彩色图表等) */
.VPDoc img.no-dark-mode-filter {
    filter: none !important;
    border: none !important; 
    box-shadow: none !important; 
}


/* ========================================================= */
/* PART C: 桌面端布局 (Desktop >= 960px) */
/* ========================================================= */
@media (min-width: 960px) {
    /* 1. 文档布局容器 (VPDoc) 居中控制 */
    .VPContent.has-sidebar .VPDoc {
        max-width: var(--vp-layout-max-width) !important; 
        margin: 0 auto !important;
        position: relative; 
        display: block !important;
        padding: 0 !important;
        padding-top: 32px;
        padding-bottom: 96px; 
    }
    
    /* 2. 左侧侧边栏 (VPSidebar) - 固定定位 + 动态计算 LEFT 值 */
    .VPSidebar {
        position: fixed !important; 
        
        /* 使用 32px 的全局变量 */
        top: calc(var(--vp-nav-height) + var(--sidebar-gap-top)) !important; 
        bottom: var(--sidebar-gap-bottom) !important; 
        width: var(--vp-sidebar-width) !important;
        
        /* 动态计算 LEFT 值，使其对齐居中内容区的左边界 */
        left: calc(
            50vw - 
            (var(--vp-layout-max-width) / 2) + 
            var(--sidebar-gap-left)
        ) !important;
        
        /* 侧边栏卡片样式 */
        border-radius: 16px !important; 
        box-shadow: var(--vp-card-shadow) !important;
        border: 1px solid var(--vp-c-divider) !important; 
        background-color: var(--vp-c-bg-soft) !important; 
        
        /* ★ 修改：侧边栏自身的垂直 padding 为 32px ★ */
        padding-top: 32px !important; 
        padding-bottom: 32px !important;
    }
    
    /* 移除默认侧边栏的边框 */
    .VPSidebar .vp-sidebar-menu { 
        border-right: none !important; 
    }
    
    /* 侧边栏内容组的间距调整 (确保内部列表的左侧也有 32px 间距) */
    .VPSidebar .group {
        /* 移除或覆盖 VitePress 默认的左侧 padding，统一使用 32px */
        padding-left: 32px !important;
        padding-right: 32px !important;
    }
    
    /* 侧边栏的链接/标题在 group 内部，确保它们不受影响或统一左侧边距 */
    .VPSidebar .link { 
        padding-left: 0 !important; /* 让链接左侧对齐 Group 的 32px */
        padding-right: 0 !important;
    }
    
    /* ---------------------------------------------------- */
    
    /* 3. 内容区容器 (VPDoc .container) 调整 */
    .VPContent.has-sidebar .VPDoc .container {
        max-width: 100% !important; 
        margin: 0 !important;
        padding: 0 !important;
        
        display: grid;
        grid-template-columns: var(--doc-content-width) minmax(0, 256px); 
        
        /* 强制内容区域从左侧移开，给侧边栏留出空间 */
        margin-left: var(--sidebar-full-width); 
        padding-right: 32px; 
    }
    
    /* 4. 文档主体内容 (VPDoc .content) */
    .VPContent.has-sidebar .VPDoc .content { 
        grid-column: 1 / 2; 
        width: 100%; 
        max-width: var(--doc-content-width); 
    }
    
    /* 5. 右侧边栏/目录 (VPDoc .aside) */
    .VPContent.has-sidebar .VPDoc .aside { 
        grid-column: 2 / 3; 
        padding-left: 32px;
        position: sticky !important;
        top: calc(var(--vp-nav-height) + 32px) !important;
        max-width: 100%;
        display: block !important; 
    }
    .curtain {
        display: none !important;
    }
}

/* 中等屏幕适配 (Tablet) */
@media (min-width: 960px) and (max-width: 1279px) {
    /* 侧边栏贴着左边缘固定 */
    .VPSidebar {
        left: var(--sidebar-gap-left) !important; /* 使用 32px 变量 */
    }
    /* 内容区向右偏移，为侧边栏留出空间 */
    .VPContent.has-sidebar .VPDoc .container {
        margin-left: var(--sidebar-full-width);
        padding-right: 32px;
    }
    /* 隐藏右侧边栏 */
    .VPContent.has-sidebar .VPDoc .aside { display: none !important; }
    .curtain {
        display: none !important;
    }
}


/* ========================================================= */
/* PART D: 手机端完全修复 (Mobile < 960px) */
/* ========================================================= */
@media (max-width: 960px) {
    
    /* 1. 导航栏内边距 - 保持不变 */
    .VPNav .VPContainer { padding: 0 16px !important; }
    
    /* 2. 手机端目录栏 (VPLocalNav) - 保持不变 */
    .VPLocalNav {
        position: sticky !important;
        top: var(--vp-nav-height) !important;
        z-index: 55 !important; 
        
        background-color: var(--glass-bg-light) !important;
        backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--vp-c-divider);
        padding-left: 16px;
    }
    :root.dark .VPLocalNav { background-color: var(--glass-bg-dark) !important; }
    
    /* 3. 手机端侧边栏 - 修正 top 值 */
    .VPSidebar {
        position: fixed !important;
        top: calc(var(--vp-nav-height) + var(--vp-local-nav-height) + 10px) !important;
        left: 10px !important;
        right: 10px !important; 
        bottom: 10px !important;
        width: auto !important;
        
        overflow-y: auto !important;
        overscroll-behavior: contain;
        
        box-shadow: 0 10px 40px rgba(0,0,0,0.15) !important;
        
        /* ★ 修改：侧边栏自身的垂直 padding 为 32px ★ */
        padding-top: 32px !important; 
        padding-bottom: 32px !important;
    }
    
    /* 手机端侧边栏标题/链接样式 - 统一左侧 padding */
    .VPSidebar .VPNavBarTitle { 
        display: flex !important; 
        /* 统一使用 32px 间距 */
        padding: 10px 32px 20px 32px !important; /* ★ 修改左/右 padding 为 32px ★ */
        border-bottom: 1px dashed var(--vp-c-divider);
        margin-bottom: 10px;
    }
    /* 侧边栏内容组的间距调整 (确保内部列表的左侧也有 32px 间距) */
    .VPSidebar .group {
        /* 移除或覆盖 VitePress 默认的左侧 padding，统一使用 32px */
        padding-left: 32px !important;
        padding-right: 32px !important;
    }
    
    .VPSidebar .link { 
        padding-left: 0 !important; /* 让链接左侧对齐 Group 的 32px */
        padding-right: 0 !important;
        border-radius: 0 !important; 
        margin: 0 !important; 
    }
    
    .VPSidebar .link.active { background: transparent !important; color: var(--vp-c-brand-1) !important; box-shadow: none !important; }
    .VPSidebar .link.active .text { color: var(--vp-c-brand-1) !important; }

    /* 4. 内容区域修正 - 确保内容被推到导航栏下方 */
    .VPContent { 
        padding-top: calc(var(--vp-nav-height) + var(--vp-local-nav-height) + 20px) !important; 
        padding-bottom: 96px; 
    }
    .VPDoc { padding: 0 16px !important; }
    
    /* 5. 遮罩层 - 移除 VPBackdrop 遮罩层显示 */
    .VPBackdrop {
        display: none !important; 
        z-index: 45 !important;
        background-color: transparent !important;
        backdrop-filter: none !important;
    }
    
    /* 额外: 隐藏 .curtain */
    .curtain {
        display: none !important;
    }
}